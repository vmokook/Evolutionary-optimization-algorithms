# Genetic Algorithm for сombinatorics problem
## Задача: использовать генетический алгоритм (возможны модификации) для решения любой задачи комбинаторики

В данной работе была выбрана задача составления оптимального расписания с помощью генетического алгоритма для бригад скорой помощи. 

#### Про задачу:
    
Отделения неотложной помощи имеют повторяющиеся 24-часовые циклы нестационарных пуассоновских поступлений и высокий уровень вариации времени обслуживания. Задача состоит в том, чтобы найти график смен, учитывающий эффекты обращений, минимизирующий среднее время ожидания пациентов и максимизирующий предпочтения бригад скорой помощи в отношении смен при ограничениях на время начала смены, продолжительности смены и общее количество доступных часов работы бригад в день.  

#### Набор данных:
- Имеется таблица со средними значениями обращений пациентов (распределенных по закону Пуассона), поступающих в течение каждого часа на протяжении суток; 

 <p align="center">
 <img width="600px" src="Image/table1.png" alt="qr"/>
</p>

- Таблица с значениями предпочтений при выборе смены;

 <p align="center">
 <img width="600px" src="Image/table2.png" alt="qr"/>
</p>

Значения предпочтений варьируются от 6 до 1, где 6 - наиболее предпочитаемая смена, 1 - наименее. 

- Также известно, что среднее время обслуживания одного пациента составляет в среднем 15 минут (время обсуживания распределено по экспоненциальному закону распределения);
- Максимальное количество человеко-часов составляет 48 ч. (как мы понимаем данное выражение - максимум за сутки суммарно все врачи могут работать 28 часов);

#### Ограничения: 
1) Не допускается сверхурочная работа, т.е. общее количество часов суммарно у всех бригад скорой помощи не должно превышать 48 часов в сутки; 
2) Каждый час должна присутсвовать хотя бы одна бригада скорой помощи; 
3) Смены могут начинаться только в то время, которое указано в таблице предпочтений (т.е. 7:00, 11:00, 15:00, 17:00, 23:00)

*Допущение* - будем считать, что с началом каждой смены на работу выходит лишь 1 бригада скорой помощи.

#### Решение:

Необходимо минимизировать среднее время ожидания пациентов и максимизировать предпочтения бригад скорой помощи, т.е. решить следующую задачу:

 <p align="center">
 <img width="300px" src="Image/2.png" alt="qr"/>
</p>

Здесь: 
- омега 1 - штраф, связанный с среднем временем ожидания пациента;
- wi - общее среднее время ожидания пациента за период времени i; 
- омега 2 - штраф, связанный с неудовлетворением предпочтений;
- Pj - предпочтения j-ой смены 
- T - сутки; 
- J - все смены за сутки.

#### Шаги генетического алгоритма:
1. Инициализация начальной популяции 
2. Вычисление приспособленности каждой особи
3. Селекция
4. Скрещивание 
5. Мутация 

Этап мутации в данной задаче опущен.

Из-за ограничений этой задачи невозможно напрямую использовать генетический алгоритм в том виде, в котором он описан выше. В частности, после скрещивания могут остаться решения, не удовлетворяющие ограничениям. Следовательно, чтобы получить выполнимый набор потомков, требуется изменить способ скрещивания, либо удалить невыполнимые решения после скрещивания и заменить их решениями с более высоким значением пригодности в старой популяции, что и реализуется в данном алгоритме. 

### Результат тетсирования алгоритма 

В ходе выполнения данной работы, была получена хромосома (график смены), которая удовлетворяет заданным ограничениям:
- В сумме продолжительность смен в день не должна превышать 48 часов;
- В каждый час должна быть хотя бы 1 свободная бригада.

Полученная хромосома: 
[0, 5, 15, 12, 1, 4]
- Смена под индексом 0 - с 7:00 8 часов
- Смена под индексом 5 - с 11:00 12 часов
- Смена под индексом 15 - пустая ячейка
- Смена под индексом 12 - с 23:00 8 часов
- Смена под индексом 1 - с 7:00 10 часов
- Смена под индексом 4 - с 11:00 10 часов

Визуализация полученной хромосомы:

 <p align="center">
 <img width="500px" src="Image/res.png" alt="qr"/>
</p>

Суммарное количество часов как раз 48, учтены все возможные предпочтения, 
